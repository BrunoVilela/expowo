---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# expowo

<!-- badges: start -->
<!-- badges: end -->

## Overview

The main goal of the __expowo__ package is to retrieve information about the 
diversity and distribution of any plant family as publicly available at the 
taxonomically verified database [Plants of the World Online (POWO)](https://powo.science.kew.org).
The package is intended to efficiently miner the content on the source html pages
for any specific genus and family. It can return a comma-separated values (CSV) 
file with the number of accepted species and distribution for any genus as well 
as the full checklist of accepted species, its authors, original publication 
and global distribution.


## Before using __expowo__

#### Update R and RStudio versions
Please make sure you have installed the latest versions of both R (<a href= "https://cran.r-project.org/bin/macosx/" target="_blank">Mac OS</a>, <a href= "https://cran.r-project.org/bin/windows/base/" target="_blank">Windows</a>) and RStudio (<a href= "https://www.rstudio.com/products/rstudio/download/" target="_blank">Mac OS /  Windows</a>: choose the free version).


## Installation

You can install the development version of expowo from [GitHub](https://github.com/) 
using the [devtools](https://github.com/r-lib/devtools) package with the following 
R code:

``` coffee
install.packages("devtools")
devtools::install_github("deborazuanny/expowo")
```
OBS.: To download the development version, you will need to have the [Git](http://git-scm.com/) software installed. And if your operating system is Microsoft Windows, you will 
also need to download the [Rtools](http://cran.r-project.org/bin/windows/Rtools/).

Otherwise, you can install __expowo__ via CRAN and run the application with the 
following R code:

``` coffee
```


## Usage

The package's four major functions (`powoGenera`, `powoSpecies`, `megaGen` and 
`toptenGen`) requires only the name of the target family (or a vector with multiple 
family names) and the associated specific URI (Uniform Resource Identifier) that 
identifies the html page for each family at POWO. These four major functions works 
with the others three auxiliary functions (`getNumb`,`getDist` and `getGenURI`)
to catch information. Respectively, `getNumb` function calculates the total number
of species within a genus, `getDist` does a complete search about native and introduced 
distribution of each species, and `getGenURI` performs cleanings and extracts the
list of species of each genus. To get the POWO URI for any accepted plant family, 
you can either look at the data frame object under *POWOcodes* that come together 
with the installed __expowo__ package, or you can use the function `get_pow` from 
the package [__taxize__](https://github.com/ropensci/taxize). So, the vector of URI 
codes is the main input file to everything you can do with expowo package. See 
below examples on how to use the expowo major functions to get the basic 
information on the global plant diversity and distribution!

#### _1. `powoGenera`: Extracting a list of plant genera_

This function produces a CSV file listing all genera with associated number of 
accepted species and their geographical distribution. You can also narrow 
down the search to focus on just a particular genus from a particular country or
a list of genera from a list of countries.

##### Example of a POWO search with `powoGenera` for a single plant family:
``` {r}
library(expowo)
powocodes <- taxize::get_pow("Fabaceae")
powocodes <- data.frame(powocodes)
powocodes <- cbind(family = "Fabaceae", powocodes)
powoGenera(dir = "results_powoGenera/",
           filename = "Fabaceae",
           powocodes$family,
           powocodes$uri,
           verbose = TRUE,
           save = TRUE)
```

Note that you can choose between the names of individual plant families or search 
for all of them just by adjusting the abovementioned code as follows.

##### Example of a POWO search with `powoGenera` using two plant families:
```{r}
library(expowo)
powocodes <- taxize::get_pow(c("Fabaceae", "Lecythidaceae"))
powocodes <- data.frame(powocodes)
powocodes <- cbind(family = c("Fabaceae", "Lecythidaceae"), powocodes)
powoGenera(dir = "results_powoGenera/",
           filename = "Fabaceae_Lecythidaceae",
           powocodes$family,
           powocodes$uri,
           verbose = TRUE,
           save = TRUE)
```


#### _2. `powoSpecies`: Extracting a list of plant species_

With this function, you will be able to produce a CSV file of each genus with 
the accepted number of species, considering hybrid species or not, according to 
the data available at POWO's database. You can also narrow down the search to 
focus on just the species from a particular country or a list of countries, as 
the following example.

##### Example of a POWO search with `powoSpecies` including hybrid species with occurence data at three countries:

```{r}
library(expowo)
powocodes <- taxize::get_pow("Typhaceae")
powocodes <- data.frame(powocodes)
powocodes <- cbind(family = "Typhaceae", powocodes)
powoSpecies(dir = "results_powoSpecies/",
            filename = "Typhaceae",
            powocodes$family, powocodes$uri,
            hybridspp = TRUE,
            country = c("Argentina", "Brazil", "French Guiana"),
            verbose = TRUE, save = TRUE)
```

Now, compare this result above with the following including only accepted species! 
##### Example of a POWO search with `powoSpecies` excluding hybrid species  with occurence data at three countries:

```{r}
library(expowo)
powocodes <- taxize::get_pow("Typhaceae")
powocodes <- data.frame(powocodes)
powocodes <- cbind(family = "Typhaceae", powocodes)
powoSpecies(dir = "results_powoSpecies/",
            filename = "Typhaceae",
            powocodes$family, powocodes$uri,
            hybridspp = FALSE,
            country = c("Argentina", "Brazil", "French Guiana"),
            verbose = TRUE, save = TRUE)
```

#### _3. `megaGen`: Extracting a list of mega-diverse genera_

This function is intended to produce a CSV file with the most diverse genera of 
any family, based on a threshold number you set. In the following example, we 
choose the plant family "Fabaceae" and considered a genus as mega-diverse 
when it has more than 500 species, as set in the argument threshold.

##### Example of a POWO search with `megaGen`:
``` {r}
powocodes <- taxize::get_pow("Fabaceae")
powocodes <- data.frame(powocodes)
powocodes <- cbind(family = "Fabaceae", powocodes)
megaGen(dir = "results_megaGen/",
        filename = "Fabaceae",
        powocodes$family, powocodes$uri,
        treshold = 500,
        verbose = TRUE,
        save = TRUE)
```


#### _4. `toptenGen`: Extracting the top ten genera with highest species diversity_

This function is relatively similar to the `megaGen`, but instead of using any 
specific threshold, it produces a CSV file listing the top ten most diverse genera
of any target plant family. The following example shows the top ten of two plant 
families: "Araceae" and "Lecythidaceae"! So, the final output of this search 
has twenty rows.

##### Example of a POWO search with `toptenGen`:

```{r}
powocodes <- taxize::get_pow(c("Araceae", "Lecythidaceae"))
powocodes <- data.frame(powocodes)
powocodes <- cbind(family = c("Araceae", "Lecythidaceae"), powocodes)
toptenGen(dir = "results_toptenGen/",
          filename = "Araceae_Lecythidaceae",
          powocodes$family,
          powocodes$uri,
          verbose = TRUE,
          save = TRUE)
```


## Documentation
A detailed description of the __expowo__'s full functionality will soon be available in [here](https://github.com/deborazuanny/expowo/tree/main/vignettes/).

The __expowo__ package is being continuously constructed! If you want to make 
suggestions, let us know! We hope it to be useful for your botanical research!

## Citation
Zuanny, D. & Cardoso, D. (2022). expowo: An R package for mining plant diversity and distribution data. https://github.com/deborazuanny/expowo
![DBOSlab logo](vignettes/DBOSlab_logo.png)
